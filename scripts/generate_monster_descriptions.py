"""
ê° ëª¬ìŠ¤í„°ë§ˆë‹¤ ì„¤ëª… ìƒì„± ë° CSV ì—…ë°ì´íŠ¸
"""
import csv
from pathlib import Path

project_root = Path(__file__).parent.parent
monsters_csv = project_root / "data" / "monsters.csv"

# ëª¬ìŠ¤í„°ë³„ ì„¤ëª… í…œí”Œë¦¿ - ì¬ì¹˜ìˆê³  ë‹¤ì–‘í•˜ê²Œ!
DESCRIPTIONS = {
    # ìŠí˜€ì§„ ìˆ² (1-10)
    1: "ì ¤ë¦¬ì²˜ëŸ¼ ë§ë‘ë§ë‘í•œ ì´ˆë³´ ëª¬ìŠ¤í„°. ìœ„í˜‘ì ì´ì§€ ì•Šì•„ ë³´ì´ì§€ë§Œ ë°©ì‹¬ì€ ê¸ˆë¬¼!",
    2: "ì•½ì‚­ë¹ ë¥¸ ë…¹ìƒ‰ ë„ê¹¨ë¹„. ë¬´ë¦¬ë¥¼ ì§€ì–´ ë‹¤ë‹ˆë©° ì—¬í–‰ìë“¤ì„ ê´´ë¡­íŒë‹¤.",
    3: "ë‚ ì¹´ë¡œìš´ ì†¡ê³³ë‹ˆë¥¼ ê°€ì§„ ì•¼ìƒ ëŠ‘ëŒ€. ë¬´ë¦¬ ì‚¬ëƒ¥ì˜ ë‹¬ì¸ì´ë‹¤.",
    4: "ì›ì‹œ ë§ˆë²•ì„ ìµíŒ ê³ ë¸”ë¦° ê¶ìˆ˜. í™”ì‚´ë³´ë‹¤ ì£¼ìˆ ì´ ë” ì •í™•í•˜ë‹¤.",
    5: "ì‚¬ì•…í•œ ê¸°ìš´ì´ ê¹ƒë“  ê³ ë¸”ë¦° ì£¼ìˆ ì‚¬. í† í…œì„ í”ë“¤ë©° ì €ì£¼ë¥¼ ìŠì¡°ë¦°ë‹¤.",
    6: "ë™êµ´ ì²œì¥ì— ë§¤ë‹¬ë¦° í¡í˜ˆ ë°•ì¥. í”¼ë¥¼ ë¹¨ì•„ë¨¹ìœ¼ë©° ì²´ë ¥ì„ íšŒë³µí•œë‹¤.",
    7: "ë¹„ëŒ€í•´ì§„ ê±°ëŒ€ ìŠ¬ë¼ì„. ì¼ë°˜ ìŠ¬ë¼ì„ë³´ë‹¤ 10ë°°ëŠ” ë¬´ê²ê³  ëŠë¦¬ë‹¤.",
    8: "ë…ì„± í¬ìë¥¼ ë¿œì–´ë‚´ëŠ” ìœ„í—˜í•œ ë²„ì„¯. ê°€ê¹Œì´ ê°€ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ë‹¤.",
    10: "ë¶ˆíƒ€ëŠ” í™”ì—¼ì˜ ì •ë ¹. ì†ëì—ì„œ ë¶ˆê½ƒì´ ëŠì„ì—†ì´ ì¶¤ì¶˜ë‹¤.",
    12: "ì‘ê³  êµí™œí•œ í™”ì—¼ ì„í”„. ì§“ê¶‚ì€ ì¥ë‚œì„ ì¦ê¸°ë©° ë¶ˆì„ ë¿Œë¦°ë‹¤.",
    13: "ë‚ ê°œì— ë¶ˆê½ƒì´ ë¶™ì€ ë°•ì¥. ë‚ ì•„ë‹¤ë‹ˆëŠ” í™”ì—¼ë³‘ì´ë¼ ë¶ˆë¦°ë‹¤.",

    # ê³ ë¸”ë¦° ì†Œêµ´ (11-20)
    11: "ê³ ë¸”ë¦° ì „ì‚¬. íˆ¬ë°•í•œ ë„ë¼ë¥¼ íœ˜ë‘ë¥´ë©° ëŒê²©í•œë‹¤.",
    14: "ë¬¼ì˜ í˜ì„ ë‹¤ë£¨ëŠ” ì •ë ¹. ìœ ì—°í•˜ê³  ë³€í™”ë¬´ìŒí•˜ë‹¤.",
    15: "ì‹ ì„±í•œ ë¹›ì„ ë°œì‚°í•˜ëŠ” ì •ë ¹. ì •í™”ì˜ í˜ì„ ì§€ë…”ë‹¤.",
    16: "ì–´ë‘ ì˜ í˜ì„ ë‹¤ë£¨ëŠ” ì‚¬ì•…í•œ ì •ë ¹. ì €ì£¼ë¥¼ í¼ëœ¨ë¦°ë‹¤.",
    17: "ê±°ëŒ€í•œ ê³°. ì—„ì²­ë‚œ ì™„ë ¥ìœ¼ë¡œ ì ì„ ì••ë„í•œë‹¤.",
    18: "ë§¹ë…ì„ í’ˆì€ ë…ì‚¬. í•œ ë²ˆ ë¬¼ë¦¬ë©´ ì¹˜ëª…ì ì´ë‹¤.",
    19: "ê±°ëŒ€í•œ ì „ê°ˆ. ë…ì¹¨ê³¼ ì§‘ê²Œë°œë¡œ ë¬´ì¥í–ˆë‹¤.",
    20: "ê±°ë¯¸ì¤„ì„ ì¹˜ê³  ë¨¹ì´ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ê±°ëŒ€ ê±°ë¯¸. ë…ì„ í’ˆê³  ìˆë‹¤.",

    # ë³´ìŠ¤ (101-110)
    101: "ìˆ²ì˜ ì§€ë°°ìì¸ ê±°ëŒ€ ê³°. ì••ë„ì ì¸ í˜ê³¼ ìƒëª…ë ¥ì„ ìë‘í•œë‹¤.",
    102: "ê³ ë¸”ë¦° ë¬´ë¦¬ì˜ ìš°ë‘ë¨¸ë¦¬. êµí™œí•˜ê³  ì”ì¸í•˜ë‹¤.",
    103: "ì–´ë‘ ì— ë¬¼ë“  ì‚¬ì•…í•œ ì •ë ¹ì™•. ê°•ë ¥í•œ ë§ˆë²•ì„ êµ¬ì‚¬í•œë‹¤.",
    104: "í™”ì—¼ì˜ ì •ë ¹ì™•. ëª¨ë“  ê²ƒì„ ë¶ˆíƒœìš°ëŠ” í™”ì—¼ì„ ë‹¤ë£¬ë‹¤.",
    105: "ëƒ‰ê¸°ì˜ ì •ë ¹ì™•. ì ˆëŒ€ì˜ë„ì˜ í˜ìœ¼ë¡œ ì ì„ ì–¼ë¦°ë‹¤.",
    106: "ë²ˆê°œì˜ ì •ë ¹ì™•. ì²œë‘¥ê³¼ ë²ˆê°œë¥¼ ììœ ìì¬ë¡œ ë¶€ë¦°ë‹¤.",
    107: "ë¬¼ì˜ ì •ë ¹ì™•. ëŒ€í•´ì˜ í˜ì„ ì†ì— ì¥ì—ˆë‹¤.",
    108: "ë¹›ì˜ ì •ë ¹ì™•. ì‹ ì„±í•œ ë¹›ìœ¼ë¡œ ì•…ì„ ì •í™”í•œë‹¤.",
    109: "ì–´ë‘ ì˜ ì •ë ¹ì™•. ëì—†ëŠ” ì–´ë‘  ì†ì—ì„œ ì €ì£¼ë¥¼ í¼ëœ¨ë¦°ë‹¤.",
    110: "ê³ ëŒ€ ìš©ì˜ í›„ì˜ˆ. ì••ë„ì ì¸ í˜ê³¼ ë§ˆë²•ì„ ì§€ë…”ë‹¤.",

    # ì—˜ë¦¬íŠ¸ (111-120)
    111: "ê³ ë¸”ë¦° ì •ì˜ˆ ì „ì‚¬. ë›°ì–´ë‚œ ì „íˆ¬ ê¸°ìˆ ì„ ê°–ì·„ë‹¤.",
    112: "ê³ ë¸”ë¦° ì•”ì‚´ì. ê·¸ë¦¼ìì²˜ëŸ¼ ì›€ì§ì´ë©° ê¸‰ì†Œë¥¼ ë…¸ë¦°ë‹¤.",
    113: "ê³ ë¸”ë¦° ê´‘ì „ì‚¬. ê´‘ê¸° ì–´ë¦° í˜ìœ¼ë¡œ ì ì„ ë‚œë„ì§ˆí•œë‹¤.",
    114: "ì˜¤í¬ ì „ì‚¬. ê³ ë¸”ë¦°ë³´ë‹¤ í›¨ì”¬ ê°•ë ¥í•œ ê´´ë¬¼ì´ë‹¤.",
    115: "ì˜¤í¬ ì£¼ìˆ ì‚¬. ê°•ë ¥í•œ ì£¼ìˆ ë¡œ ì ì„ ë†ë½í•œë‹¤.",
    116: "ì˜¤í¬ ëŒ€ì¥. ì˜¤í¬ ë¬´ë¦¬ë¥¼ ì´ë„ëŠ” ê°•ë ¥í•œ ì „ì‚¬ë‹¤.",
    117: "íŠ¸ë¡¤. ì—„ì²­ë‚œ ì¬ìƒë ¥ê³¼ í˜ì„ ê°€ì§„ ê±°ëŒ€ ëª¬ìŠ¤í„°.",
    118: "íŠ¸ë¡¤ ê´‘ì „ì‚¬. ë¶„ë…¸ì— íœ©ì‹¸ì—¬ í­ì£¼í•˜ëŠ” ê´´ë¬¼.",
    119: "ì˜¤ìš°ê±°. ê±°ëŒ€í•œ ëª¸ì§‘ê³¼ ì™„ë ¥ìœ¼ë¡œ ì ì„ ì§“ë°ŸëŠ”ë‹¤.",
    120: "ì˜¤ìš°ê±° ë§ˆë²•ì‚¬. ê°•ë ¥í•œ ë§ˆë²•ì„ êµ¬ì‚¬í•˜ëŠ” í¬ê·€í•œ ê°œì²´.",
}

# íƒ€ì…ë³„ ê¸°ë³¸ ì„¤ëª…
TYPE_DESCRIPTIONS = {
    "CommonMob": "í”í•˜ê²Œ ë³¼ ìˆ˜ ìˆëŠ” ëª¬ìŠ¤í„°",
    "EliteMob": "ê°•ë ¥í•œ ì •ì˜ˆ ëª¬ìŠ¤í„°",
    "BossMob": "ë˜ì „ì˜ ì§€ë°°ì"
}

# ì†ì„±ë³„ ì„¤ëª… ì¶”ê°€
ATTRIBUTE_DESCRIPTIONS = {
    "í™”ì—¼": "ëœ¨ê±°ìš´ í™”ì—¼ì„ ë‹¤ë£¨ëŠ”",
    "ëƒ‰ê¸°": "ì°¨ê°€ìš´ ëƒ‰ê¸°ë¥¼ ë‹¤ë£¨ëŠ”",
    "ë²ˆê°œ": "ë²ˆê°œë¥¼ ì¡°ì¢…í•˜ëŠ”",
    "ìˆ˜ì†ì„±": "ë¬¼ì˜ í˜ì„ ì§€ë‹Œ",
    "ì‹ ì„±": "ì‹ ì„±í•œ ë¹›ì„ ë°œì‚°í•˜ëŠ”",
    "ì•”í‘": "ì–´ë‘ ì˜ í˜ì„ í’ˆì€",
    "ë¬¼ë¦¬": "ìˆœìˆ˜í•œ ì™„ë ¥ì„ ì§€ë‹Œ",
    "ë³µí•©": "ì—¬ëŸ¬ ì†ì„±ì˜ í˜ì„ ë‹¤ë£¨ëŠ”",
}

def generate_description(row):
    """ëª¬ìŠ¤í„° ì„¤ëª… ìƒì„±"""
    monster_id = int(row['ID'])
    name = row['ì´ë¦„']
    monster_type = row.get('íƒ€ì…', 'CommonMob')
    attribute = row.get('ì†ì„±', 'ì—†ìŒ')

    # ë¯¸ë¦¬ ì •ì˜ëœ ì„¤ëª…ì´ ìˆìœ¼ë©´ ì‚¬ìš©
    if monster_id in DESCRIPTIONS:
        return DESCRIPTIONS[monster_id]

    # ìë™ ìƒì„±
    parts = []

    # ì†ì„± ê¸°ë°˜
    if attribute in ATTRIBUTE_DESCRIPTIONS:
        parts.append(ATTRIBUTE_DESCRIPTIONS[attribute])

    # íƒ€ì… ê¸°ë°˜
    if monster_type in TYPE_DESCRIPTIONS:
        parts.append(TYPE_DESCRIPTIONS[monster_type])

    if parts:
        return f"{' '.join(parts)}. ì¡°ì‹¬í•´ì„œ ìƒëŒ€í•´ì•¼ í•œë‹¤."

    return "ì •ì²´ë¥¼ ì•Œ ìˆ˜ ì—†ëŠ” ëª¬ìŠ¤í„°. ë¬´ì„œìš´ ê¸°ìš´ì´ ëŠê»´ì§„ë‹¤..."

def main():
    print("ğŸ”„ ëª¬ìŠ¤í„° ì„¤ëª… ìƒì„± ì¤‘...")

    # CSV ì½ê¸°
    with open(monsters_csv, 'r', encoding='utf-8-sig') as f:
        reader = csv.DictReader(f)
        fieldnames = reader.fieldnames
        rows = list(reader)

    # 'ì„¤ëª…' ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ì¶”ê°€
    if 'ì„¤ëª…' not in fieldnames:
        # 'ì´ë¦„' ë‹¤ìŒì— 'ì„¤ëª…' ì¶”ê°€
        new_fieldnames = []
        for field in fieldnames:
            new_fieldnames.append(field)
            if field == 'ì´ë¦„':
                new_fieldnames.append('ì„¤ëª…')
        fieldnames = new_fieldnames

    # ê° í–‰ì— ì„¤ëª… ì¶”ê°€
    updated_count = 0
    for row in rows:
        if not row.get('ì„¤ëª…') or row.get('ì„¤ëª…').strip() == '':
            row['ì„¤ëª…'] = generate_description(row)
            updated_count += 1
            print(f"  {row['ID']:>3}. {row['ì´ë¦„']}: {row['ì„¤ëª…'][:50]}...")

    # CSV ì“°ê¸°
    with open(monsters_csv, 'w', encoding='utf-8-sig', newline='') as f:
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        writer.writeheader()
        writer.writerows(rows)

    print(f"\nâœ… {updated_count}ê°œ ëª¬ìŠ¤í„° ì„¤ëª… ìƒì„± ì™„ë£Œ!")
    print(f"ğŸ“„ ì—…ë°ì´íŠ¸ëœ íŒŒì¼: {monsters_csv}")

if __name__ == "__main__":
    main()
